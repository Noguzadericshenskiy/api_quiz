

### Задачи:
####  Создание пользователя, POST:
    
    1.	Принимает на вход запросы с именем пользователя;
    2.	Создаёт в базе данных пользователя заданным именем,
            так же генерирует уникальный идентификатор пользователя и UUID токен доступа
            (в виде строки) для данного пользователя;
    3.	Возвращает сгенерированные идентификатор пользователя и токен.


#### Необходимо реализовать веб-сервис, выполняющий следующие функции:
1.	Создание пользователя;
2.	Для каждого пользователя - сохранение аудиозаписи в формате wav, преобразование её в формат mp3 и запись в базу данных и предоставление ссылки для скачивания аудиозаписи.


    1. В сервисе реализован POST REST метод, принимающий на вход запросы с
       содержимым вида {"questions_num": integer}.
    2. После получения запроса сервис, запрашивает с публичного API
       (англоязычные вопросы для викторин) https://jservice.io/api/random?count=1 указанное
       в полученном запросе количество вопросов.
    3. Далее, полученные ответы сохраняются в базе данных из п. 1б а именно, следующая информация:
        1. ID вопроса,
        2. Текст вопроса,
        3. Текст ответа,
        4. Дата создания вопроса.

        В случае, если в БД имеется такой же вопрос, к публичному API с викторинами
        выполняются дополнительные запросы, до тех пор, пока не будет получен уникальный
        вопрос для викторины.
    4. Ответ на запрос сервис возвращает список последних обавленных вопросов.


#### Основной стек
- Python - яп
- FastAPI - основной фреймворк
- PostgreSQL - база данных
- SQLalchemy - ORM
- docker-compose - контейнеризация для запуска и тестирования
- alembiс - развертывание базы данных и дальнейших миграций 
- pydantic - валидация данных
- pydub - конвертирование файлов 
- venv - виртуальная среда разработки


### Установка и запуск
#### Установка
Все файлы с настройками, в папке `example`, необходимо или создать свои настройки или скопировать эти файлы, 
или заменить имеющиеся после установки алембика! 
1. Создайте папку для проекта в которую необходимо склонировать из репозитория файлы проекта командой `git clone`. 
Необходимо учитывать, что после запуска приложения в корневой папке проекта, будет создана 
папка `data` для хранения данных БД. 
2. Создать в корне проекта файл `.env` и добавить в него необходимые данные
3. Установить все зависимости и `alembic`, для этого выполните команды:
   - `pip install -r requirements.txt` или выполните установку из IDE
   -  при необходимости обновите pip
4. скопировать все файлы из папки `example` в соответствующие места 


#### Запуск 
Для запуска приложения необходимо: 
1. Создать контейнер с БД, для этого необходимо выполнить команду
`docker compose -f docker-compose_db.yml up --build`
2. Сделать первую миграцию-инициализацию базы данных, для этого нужно
- инициализировать алембик командой `alembic init migrations`
- сделать первую ревизию командой `alembic revision --autogenerate -m "init"`
- обновить базу данных командой `alembic upgrade head` которая создаст таблицы в базе
3. Запустить приложение командой `uvicorn main:app --reload`

Все это можно сделать командами из `Makefile` 

Для правильного конвертирования файлов, необходимо установить библиотеку ffmpeg используя это `apt-get install libav-tools libavcodec-extra`, если установить не получилось используйте 
офф документацию по ссылке `https://blog.gregzaal.com/how-to-install-ffmpeg-on-windows/`




